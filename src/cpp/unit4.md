---
title: C++ Primer Plus 第四章阅读笔记 - 复合类型
---

# 数组

数组是一种数据格式，能够存储多个**同类型**的数值。

声明数组的通用格式：

```c++
typeName arrayName[arraySize];
```

## 初始化数组元素

我们可以使用大括号初始化方法**在声明时**（且**仅**在声明时）将数组初始化。

```c++
int scores[5] = {1, 2, 3, 4, 5};
```

不能将一个数组直接赋值给另一个数组。

```c++
int scores[5] = {1, 2, 3, 4, 5};
int ranks[5] = scores;//not allowed
```

初始化时提供的**元素值的个数**可以**少于**数组的**元素数目**，此时其他元素会被设置为`0`。

```c++
int scores[5] = {0, 1};
cout << scores[2];//0
```

> 于是如果想把数组全部初始化为0，可以这么做：
>
> ```c++
> int scores[5] = {0};
> int scores[5] = {};//c++11，略掉了0
> int scores[5]{};//c++11，略掉了等号和0
> ```

初始化时不提供`[]`内的值，那么C++编译器将自动计算元素个数。

值得一提的是，使用列表初始化时，不允许**缩窄转换**（备忘：硬赋“吃不下”的值）。

## 针对数组的`sizeof`

`sizeof`作用于**数组名**，得到的是整个数组的字节数；作用于数组中的某个元素，则是单个该元素占用的字节数。

```c++
int scores[5] = {1, 2, 3, 4, 5};
cout << sizeof scores << endl;//20 p.s. 4 * 5 = 20
cout << sizeof scores[2] << endl;//4
```

# 字符串

> 此处先介绍C风格字符串（char数组），下一小节介绍`string`类

`char`数组不一定是字符串，因为字符串要求以`\0`结尾。如果一个`char`数组并未以`\0`结尾，那么不应视为字符串处理，更不应使用相关函数对其进行处理，否则这些函数会一直顺着内存读下去，直至遇到`\0`。

```c++
char c1[] = {'h', 'i'};//Not a string
char c2[] = {'h', 'i', '\0'};//Right
```

## 初始化字符串

我们可以使用**字符串常量**对`char`数组进行初始化

```c++
char c1[] = "Aoligei!";
```

用**双引号**扩起的字符串**隐式地包括结尾的空字符**，譬如：

```c++
char c1[8] = "Bozo";
// B o z o \0(这个是自动加到字符串末尾的，后续其他的也会设置为\0) \0 \0 \0
```

::: danger 区分字符常量和字符串常量

字符常量用**单引号**包裹，**本质是**字符串**编码**的简略表示。在ASCII系统中，`'s' == 83`，`'s'`只是`83`的另外一个写法罢了。

字符串常量用**双引号**包裹，如`"s"`，其代表由`'s'`、`'\0'`组成的字符串。C++中视为字符串**所在的内存地址**。

:::

## 字符串常量拼接

任何两个被空白（空格、制表符、换行符）分割开来的字符串会被自动拼接成一个。

```c++
char c1[] = "Aoligei!"
            "Split!";
cout << c1;//Aoligei!Split!
```

