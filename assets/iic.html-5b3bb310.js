import{_ as n,F as o,W as i,X as r,Y as s,Z as t,a0 as e,$ as l}from"./framework-9e409b07.js";const c="/assets/iic_desc-b8b13254.svg",p="/assets/iic_construct-ae37f98b.svg",h="/assets/iic_con-1691060540431-2-b1934c92.svg",m="/assets/iic_s_p-137e8be6.svg",d="/assets/iic_byte-87d13f1d.svg",g="/assets/iic_find_byte-285d531b.svg",_="/assets/iic_host_to_slave-2646f704.svg",u="/assets/iic_slave_to_host-82c89f12.svg",f="/assets/iic_change-2da06fb9.svg",b={},v={href:"https://blog.csdn.net/shaguahaha/article/details/70766665",target:"_blank",rel:"noopener noreferrer"},x={href:"https://blog.csdn.net/shaguahaha/article/details/70766665%EF%BC%89",target:"_blank",rel:"noopener noreferrer"},y={href:"http://creativecommons.org/licenses/by-sa/4.0/",target:"_blank",rel:"noopener noreferrer"},k=s("h1",{id:"简介",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#简介","aria-hidden":"true"},"#"),t(" 简介")],-1),C=s("p",null,[t("IIC又称为"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msup",null,[s("mi",{mathvariant:"normal"},"I"),s("mn",null,"2")]),s("mi",{mathvariant:"normal"},"C")]),s("annotation",{encoding:"application/x-tex"},"\\mathrm{I^2C}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8141em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"I"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8141em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathrm mtight"},"2")])])])])])])]),s("span",{class:"mord mathrm"},"C")])])])])],-1),I=l('<ol><li><p>IIC有两根数据线：数据线<code>SDA</code>、时钟线<code>SCL</code></p></li><li><p>IIC上可以挂<strong>多个</strong>主设备、<strong>多个</strong>从设备</p><figure><img src="'+c+'" alt="iic_desc" tabindex="0"><figcaption>iic_desc</figcaption></figure></li><li><p>多主机会产生<strong>总线裁决</strong>问题。当多个主机同时想占用总线时，企图启动总线传输数据，就叫做总线竞争。I2C通过总线仲裁，以决定让哪台主机控制总线</p></li><li><p>IIC总线通过上拉电阻接正电源。当<strong>总线空闲</strong>时，<strong><em>两</em>根线均为高电平</strong>。连到总线上的<strong>任一器件输出低电平</strong>，<strong>都将使总线的信号变低</strong></p></li><li><p>每个接到IIC总线上的<strong>器件都有唯一的地址</strong></p></li><li><p>从下图可以看到，任一器件可以拉低<code>SDA</code>或<code>SCL</code></p></li></ol><figure><img src="'+p+'" alt="iic_construct" tabindex="0"><figcaption>iic_construct</figcaption></figure><h1 id="数据传送" tabindex="-1"><a class="header-anchor" href="#数据传送" aria-hidden="true">#</a> 数据传送</h1><h2 id="数据位的有效性规定" tabindex="-1"><a class="header-anchor" href="#数据位的有效性规定" aria-hidden="true">#</a> 数据位的有效性规定</h2><p>IIC总线<strong>进行数据传送</strong>时，<strong>时钟信号为高电平期间</strong>，<strong>数据线上的数据必须保持稳定</strong>；只有在时钟线上的信号为低电平期间，数据线上的高电平或低电平状态才允许变化。</p><figure><img src="'+h+'" alt="iic_con" tabindex="0"><figcaption>iic_con</figcaption></figure><h2 id="起始与终止信号" tabindex="-1"><a class="header-anchor" href="#起始与终止信号" aria-hidden="true">#</a> 起始与终止信号</h2><p><strong><code>SCL</code>为高电平期间</strong>：</p><ul><li>起始信号：<code>SCL</code>为高电平期间，<code>SDA</code>从高到低</li><li>终止信号：<code>SCL</code>为高电平期间，<code>SDA</code>从低到高</li></ul><blockquote><p>也就是说，正常传送数据期间，当<code>SCL</code>处于高电平时，<code>SDA</code>不能变化；</p><p>但是是在传输起始、终止时，当<code>SCL</code>处于高电平时，允许<code>SDA</code>变化，并且<code>SDA</code>的变化指示着数据传输的起始与终止。</p></blockquote><figure><img src="'+m+'" alt="IIC起始信号与终止信号" tabindex="0"><figcaption>IIC起始信号与终止信号</figcaption></figure><p>起始信号和终止信号<strong>都是由主机发送</strong>的。在起始信号产生之后，总线就处于被占用的状态，在终止信号产生之后，总线就处于空闲状态。</p><h2 id="数据传送格式" tabindex="-1"><a class="header-anchor" href="#数据传送格式" aria-hidden="true">#</a> 数据传送格式</h2><h3 id="字节的传送与应答" tabindex="-1"><a class="header-anchor" href="#字节的传送与应答" aria-hidden="true">#</a> 字节的传送与应答</h3><p>每当发送端（可能是从机，也可能是主机）<strong>传输完一个字节的数据之后</strong>，<strong>发送端会等待</strong>一段时间来<strong>接收端的应答信号</strong>。<strong>接收端</strong>通过<strong>拉低<code>SDA</code>数据线</strong>，给发送端发送一个应答信号，以提醒发送端：“我这边已经接受完成，数据可以继续传输！”。接下来，发送端就可以继续发送数据了。</p><blockquote><p>传输的起始与终止信号由主机发出！</p><p>每个字节的应答信号由这个字节的接收端（可能是主机，也可能是从机）发出！</p></blockquote><p>每一个字节必须保证是8位长度；数据传送时，<strong>先传送最高位(MSB)</strong>，每一个<strong>被传送的字节后面都必须跟一位应答位</strong>（即一帧共有9位）。</p><p>下图以主机发出起始信号后，传给从机的第一个字节（寻址字节）的过程做例子：</p><figure><img src="'+d+'" alt="iic_byte" tabindex="0"><figcaption>iic_byte</figcaption></figure><p>有一些特殊情况，接收端可以不做应答（做“非应答”）：</p><blockquote><p>由于某种原因从机不对主机寻址信号应答时(如从机正在进行实时性的处理工作而无法接收总线上的数据)，它必须将数据线置于高电平，而由主机产生一个终止信号以结束总线的数据传送</p><p>如果从机对主机进行了应答，但在数据传送一段时间后无法继续接收更多的数据时，<strong>从机可以通过对无法接收的第一个数据字节的&quot;非应答&quot;通知主机</strong>，主机则应发出终止信号以结束数据的继续传送</p><p>当<strong>主机接收数据</strong>时，它<strong>收到最后一个数据字节</strong>后，必须向从机发出一个结束传送的信号：这个信号是由对从机的&quot;<strong>非应答</strong>&quot;来实现的。然后，从机释放<code>SDA</code>线，以允许主机产生终止信号</p></blockquote><h3 id="总线寻址" tabindex="-1"><a class="header-anchor" href="#总线寻址" aria-hidden="true">#</a> 总线寻址</h3><p><strong>主机在起始信号之后</strong>，<strong>紧接着就向总线上发送8位（1字节）数据</strong>，用于<strong>寻址</strong>。这8位数据是在起始信号之后发送的第一个字节，这个字节后面的字节都是数据，不再是寻址，除非又重新来一个起始信号。</p><p>寻址字节的位定义如下：</p><figure><img src="'+g+'" alt="iic_find_byte" tabindex="0"><figcaption>iic_find_byte</figcaption></figure><p>D7~D1组成从机地址；D0是数据传送方向位，为0代表主机向从机写数据，为1代表主机由从机读数据。</p>',26),w=s("p",null,[t("主机发送地址时，"),s("strong",null,"总线上的每个从机都将这7位地址码与自己的地址进行比较"),t("，若相同，则认为自己正在被主机寻址，根据"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"R"),s("mi",{mathvariant:"normal"},"/"),s("mover",{accent:"true"},[s("mi",{mathvariant:"normal"},"W"),s("mo",{stretchy:"true"},"‾")])]),s("annotation",{encoding:"application/x-tex"},"\\mathrm{R/\\overline{W}}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1333em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"R/"),s("span",{class:"mord overline"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8833em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathrm",style:{"margin-right":"0.01389em"}},"W")])]),s("span",{style:{top:"-3.8033em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"overline-line",style:{"border-bottom-width":"0.04em"}})])])])])])])])])]),t("位将自己确定为发送器或接收器。")],-1),S=s("h3",{id:"数据传送-1",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#数据传送-1","aria-hidden":"true"},"#"),t(" 数据传送")],-1),D=s("p",null,[t("若"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"R"),s("mi",{mathvariant:"normal"},"/"),s("mover",{accent:"true"},[s("mi",{mathvariant:"normal"},"W"),s("mo",{stretchy:"true"},"‾")])]),s("annotation",{encoding:"application/x-tex"},"\\mathrm{R/\\overline{W}}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1333em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"R/"),s("span",{class:"mord overline"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8833em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathrm",style:{"margin-right":"0.01389em"}},"W")])]),s("span",{style:{top:"-3.8033em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"overline-line",style:{"border-bottom-width":"0.04em"}})])])])])])])])])]),t("位为0，即主机向从机写数据，在从机向主机应答后，主机就开始发送数据。")],-1),q=s("blockquote",null,[s("p",null,"注意：主机向从机发送最后一个字节时，从机可以选择应答，也可以不应答。")],-1),L=s("figure",null,[s("img",{src:_,alt:"iic_host_to_slave",tabindex:"0"}),s("figcaption",null,"iic_host_to_slave")],-1),M=s("p",null,[t("若"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"R"),s("mi",{mathvariant:"normal"},"/"),s("mover",{accent:"true"},[s("mi",{mathvariant:"normal"},"W"),s("mo",{stretchy:"true"},"‾")])]),s("annotation",{encoding:"application/x-tex"},"\\mathrm{R/\\overline{W}}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1333em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathrm"},"R/"),s("span",{class:"mord overline"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8833em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathrm",style:{"margin-right":"0.01389em"}},"W")])]),s("span",{style:{top:"-3.8033em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"overline-line",style:{"border-bottom-width":"0.04em"}})])])])])])])])])]),t("位为1，即主机由从机读数据，即从机向主机发数据的话，"),s("strong",null,"从机"),t("向主机"),s("strong",null,"应答后"),t("，接下来就会主动向主机发数据。")],-1),A=s("blockquote",null,[s("p",null,[t("注意：从机向主机发送最后一个字节时，"),s("strong",null,"主机必须不应答"),t("！（只有这样，才能让从机释放掉"),s("code",null,"SDA"),t("线，接下来主机才能发出终止信号）")])],-1),W=s("figure",null,[s("img",{src:u,alt:"iic_slave_to_host",tabindex:"0"}),s("figcaption",null,"iic_slave_to_host")],-1),R=s("p",null,"若要在传输过程中改变数据传送的方向，起始信号和从机地址都被重复一次产生一次，但两次读/写方向位正好相反。",-1),B=s("figure",null,[s("img",{src:f,alt:"iic_change",tabindex:"0"}),s("figcaption",null,"iic_change")],-1);function N(E,V){const a=o("ExternalLinkIcon");return i(),r("div",null,[s("blockquote",null,[s("p",null,[t("本文很大程度参考了："),s("a",v,[t("IIC详解，包括原理、过程，最后一步步教你实现IIC_iic协议_shaguahaha的博客-CSDN博客"),e(a)]),t("，感谢原作者的分享！（"),s("a",x,[t("https://blog.csdn.net/shaguahaha/article/details/70766665）"),e(a)])]),s("p",null,[t("原作遵循"),s("a",y,[t(" CC 4.0 BY-SA "),e(a)]),t("版权协议。本文同样遵守。")])]),k,C,I,w,S,D,q,L,M,A,W,R,B])}const F=n(b,[["render",N],["__file","iic.html.vue"]]);export{F as default};
